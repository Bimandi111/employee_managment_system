<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Employee Management System</title>
    <link rel="stylesheet" href="src/css/style.css"/>
</head>
<body>

<!-- login -->
<div id="loginScreen" class="login-screen">
    <div class="login-card">
        <div class="login-logo">
            <div style="background-color:#2563eb; border-radius:25%; padding:0.5rem; display:inline-flex; align-items:center; justify-content:center;">
                <img src="src/img/user-svgrepo-com.svg" width="48" height="48" alt="logo"/>
            </div>
        </div>

        <h1>Employee Management</h1>

        <p class="login-subtitle">Sign in to your account</p>

        <div id="loginError" class="alert alert-error hidden"></div>
        <div class="form-group">
            <label for="loginUsername" style="margin-left: -15.5rem;">Username:</label>
            <input type="text" id="loginUsername" placeholder="Enter username" autocomplete="username"/>
        </div>

        <div class="form-group">
            <label for="loginPassword" style="margin-left: -15.5rem;">Password:</label>
            <input type="password" id="loginPassword" placeholder="Enter password" autocomplete="current-password"/>
        </div>
        <button class="btn btn-primary btn-full" id="loginBtn" onclick="handleLogin()">
            <span id="loginBtnText">Sign In</span>
        </button>
        <p class="login-hint">Default: admin / Admin@1234</p>
    </div>
</div>

<div id="appScreen" class="app hidden">

    <!-- sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <svg width="32" height="32" viewBox="0 0 48 48" fill="none">
                <rect width="48" height="48" rx="10" fill="#2563eb"/>
                <path d="M14 34c0-5.52 4.48-10 10-10s10 4.48 10 10" stroke="white" stroke-width="2.5"
                      stroke-linecap="round"/>
                <circle cx="24" cy="18" r="6" stroke="white" stroke-width="2.5"/>
            </svg>
            <span>EMS</span>
        </div>
        <nav class="sidebar-nav">
            <a class="nav-item active" data-page="dashboard" onclick="navigateTo('dashboard')">
                <svg viewBox="0 0 24 24">
                    <rect x="3" y="3" width="7" height="7" rx="1"/>
                    <rect x="14" y="3" width="7" height="7" rx="1"/>
                    <rect x="3" y="14" width="7" height="7" rx="1"/>
                    <rect x="14" y="14" width="7" height="7" rx="1"/>
                </svg>
                Dashboard
            </a>
            <a class="nav-item" data-page="employees" onclick="navigateTo('employees')">
                <svg viewBox="0 0 24 24">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
                Employees
            </a>
            <a class="nav-item" data-page="past" onclick="navigateTo('past')">
                <svg viewBox="0 0 24 24">
                    <path d="M20 9V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v2"/>
                    <path d="M20 9v11a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9"/>
                    <path d="M12 12v6"/>
                    <path d="M8 12l4-4 4 4"/>
                </svg>
                Past Employees
            </a>
        </nav>
        <div class="sidebar-footer">
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">A</div>
                <div>
                    <div class="user-name" id="sidebarUsername">—</div>
                    <div class="user-role" id="sidebarRole">—</div>
                </div>
            </div>
            <button class="btn-logout" onclick="handleLogout()" title="Logout">
                <svg viewBox="0 0 24 24" width="18" height="18">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16 17 21 12 16 7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
            </button>
        </div>
    </aside>

    <!-- main -->
    <main class="main-content">

        <!--dashboard-->
        <div id="page-dashboard" class="page active">
            <div class="page-header">
                <h2>Dashboard</h2>
                <p>Welcome to the Employee Management System</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <svg viewBox="0 0 24 24">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="statTotal">—</div>
                        <div class="stat-label">Active Employees</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <svg viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <line x1="9" y1="9" x2="15" y2="9"/>
                            <line x1="9" y1="12" x2="15" y2="12"/>
                            <line x1="9" y1="15" x2="11" y2="15"/>
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="statDepts">—</div>
                        <div class="stat-label">Departments</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon orange">
                        <svg viewBox="0 0 24 24">
                            <path d="M20 9V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v2"/>
                            <path d="M20 9v11a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9"/>
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="statPast">—</div>
                        <div class="stat-label">Past Employees</div>
                    </div>
                </div>
            </div>

            <div class="recent-section">
                <h3>Recent Employees</h3>
                <div id="recentList" class="recent-list"></div>
            </div>
        </div>

        <!--employees-->
        <div id="page-employees" class="page">
            <div class="page-header">
                <div>
                    <h2>Employees</h2>
                    <p>Manage your active workforce</p>
                </div>
                <button class="btn btn-primary" onclick="openEmployeeModal()">
                    <svg viewBox="0 0 24 24" width="16" height="16">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    Add Employee
                </button>
            </div>

            <!-- search bar -->
            <div class="search-bar">
                <div class="search-group">
                    <svg viewBox="0 0 24 24" width="16" height="16" class="search-icon">
                        <circle cx="11" cy="11" r="8"/>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                    </svg>
                    <input type="text" id="searchName" placeholder="       Search by name..." oninput="handleSearch()"/>
                </div>
                <select id="searchDept" onchange="handleSearch()">
                    <option value="">All Departments</option>
                </select>
                <select id="searchPos" onchange="handleSearch()">
                    <option value="">All Positions</option>
                </select>
                <input type="date" id="searchDate" onchange="handleSearch()" title="Filter by hire date"/>
                <button class="btn btn-secondary" onclick="clearSearch()">Clear</button>
            </div>

            <div id="employeeAlert" class="alert hidden"></div>
            <div id="employeeList" class="table-container"></div>
        </div>

        <!--past employees-->
        <div id="page-past" class="page">
            <div class="page-header">
                <div>
                    <h2>Past Employees</h2>
                    <p>Archive of former employees</p>
                </div>
            </div>
            <div id="pastList" class="table-container"></div>
        </div>

    </main>
</div>

<!--employee view-->
<div id="employeeModal" class="modal-overlay hidden" onclick="closeModalOnOverlay(event)">
    <div class="modal">
        <div class="modal-header">
            <h3 id="modalTitle">Add Employee</h3>
            <button class="modal-close" onclick="closeEmployeeModal()">×</button>
        </div>

        <div class="modal-body">
            <div id="modalAlert" class="alert hidden"></div>
            <form id="employeeForm" onsubmit="return false;">
                <input type="hidden" id="empId"/>
                <div class="form-row">
                    <div class="form-group">
                        <label for="empFirstName">First Name *</label>
                        <input type="text" id="empFirstName" placeholder="e.g. Selena" required/>
                    </div>
                    <div class="form-group">
                        <label for="empLastName">Last Name *</label>
                        <input type="text" id="empLastName" placeholder="e.g. Gomez" required/>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="empEmail">Email *</label>
                        <input type="email" id="empEmail" placeholder="selena.gomez@company.com" required/>
                    </div>

                    <div class="form-group">
                        <label for="empPhone">Phone</label>
                        <input type="tel" id="empPhone" placeholder="+94771234567"/>
                    </div>

                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="empDepartment">Department *</label>
                        <select id="empDepartment" required></select>
                    </div>

                    <div class="form-group">
                        <label for="empPosition">Position *</label>
                        <select id="empPosition" required></select>
                    </div>

                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="empHireDate">Hire Date *</label>
                        <input type="date" id="empHireDate" required/>
                    </div>

                    <div class="form-group">
                        <label for="empSalary">Salary (LKR) *</label>
                        <input type="number" id="empSalary" min="0" step="0.01" placeholder="75000.00" required/>
                    </div>

                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeEmployeeModal()">Cancel</button>
            <button class="btn btn-primary" id="saveBtn" onclick="saveEmployee()">Save Employee</button>
        </div>
    </div>
</div>

<!--delete confirmation-->
<div id="deleteModal" class="modal-overlay hidden" onclick="closeModalOnOverlay(event)">
    <div class="modal modal-sm">
        <div class="modal-header">
            <h3>Archive Employee</h3>
            <button class="modal-close" onclick="closeDeleteModal()">×</button>
        </div>

        <div class="modal-body">
            <p>Are you sure you want to archive <strong id="deleteEmpName"></strong>?</p>
            <p class="text-muted">This employee will be moved to <em>Past Employees</em> and will not be permanently
                deleted.</p>
            <div class="form-group" style="margin-top:1rem">
                <label for="deleteReason">Reason (optional)</label>
                <input type="text" id="deleteReason" placeholder="e.g. Resigned, Contract ended..."/>
            </div>

        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
            <button class="btn btn-danger" onclick="confirmDelete()">Archive Employee</button>
        </div>
    </div>
</div>

<!--view-->
<div id="viewModal" class="modal-overlay hidden" onclick="closeModalOnOverlay(event)">
    <div class="modal">
        <div class="modal-header">
            <h3>Employee Details</h3>
            <button class="modal-close" onclick="document.getElementById('viewModal').classList.add('hidden')">×
            </button>
        </div>
        <div class="modal-body" id="viewModalBody"></div>
    </div>
</div>

<script src="src/js/script.js"></script>
</body>
</html>
